<article class="post" 
         role="article" 
         data-post-id="{{ post.get('id', '') }}"
         tabindex="0"
         aria-labelledby="post-author-{{ post.get('id', 'unknown') }}"
         aria-describedby="post-content-{{ post.get('id', 'unknown') }} post-meta-{{ post.get('id', 'unknown') }}">

    <div class="status">
        
        <header class="post_header">
            <div class="user" 
                 role="group" 
                 aria-label="Post author information"
                 id="post-author-{{ post.get('id', 'unknown') }}">

                <div class="avatar">
                    <a href="{{ post['account_url'] }}" 
                       target="_blank" 
                       rel="noopener"
                       aria-label="View {{ post['raw_display_name'] }}'s profile">
                        <img src="{{ post['account_avatar'] }}" 
                             alt="" 
                             role="presentation"
                             loading="lazy"
                             decoding="async">
                    </a>
                </div>
            
                <a href="{{ post['account_url'] }}" 
                   target="_blank" 
                   rel="noopener"
                   class="user-link"
                   aria-label="View profile of {{ post['raw_display_name'] }}, username {{ post['username'] }}">
                    <span class="displayname">{{ post['display_name'] }}</span>
                    <span class="username">@{{ post['username'] }}</span>
                </a>

            </div>

            <nav class="links" 
                 aria-label="Post actions"
                 role="group">
                <a href="{{ post['home_url'] }}"
                   target="_blank"
                   rel="noopener"
                   data-link="home"
                   aria-label="Open post on your home instance">
                    home
                </a>
                <a href="{{ post['original_url'] }}"
                   target="_blank"
                   rel="noopener"
                   data-link="original"
                   aria-label="Open original post">
                    original
                </a>
            </nav>

        </header>

        <div class="post_content">
            <div class="content" 
                 id="post-content-{{ post.get('id', 'unknown') }}"
                 role="main"
                 aria-label="Post content">
                {{ post['content'] | safe }}
            </div>

            {% if post['media'] %}
            <div class="medias medias-count-{{ post['media']|length }}" 
                 role="group" 
                 aria-label="Media attachments">
                {% for media in post['media'] %}
                <figure class="media-item media-type-{{ media.type }}">
                    {% if media.is_video %}
                    <video src="{{ media.original_url }}" 
                           {% if media.autoplay %}autoplay loop muted playsinline{% endif %}
                           controls 
                           preload="metadata">
                    </video>
                    {% else %}
                    <a href="{{ media.original_url }}" target="_blank" rel="noopener">
                        <img src="{{ media.preview_url }}" 
                             alt="{{ media.description_attr }}" 
                             loading="lazy" 
                             decoding="async">
                    </a>
                    {% endif %}
                    {% if media.description_text %}
                    <figcaption>{{ media.description_text }}</figcaption>
                    {% endif %}
                </figure>
                {% endfor %}
            </div>
            {% endif %}
        </div>

        <footer class="post_footer" 
                id="post-meta-{{ post.get('id', 'unknown') }}"
                role="contentinfo">

            <time class="published date" 
                  data-date="{{ post['created_at'] }}"
                  datetime="{{ post['created_at'] }}"
                  aria-label="Posted at {{ post['created_at'] }}">
                <!-- JavaScript will populate this -->
            </time>
            
            <div class="reactions" 
                 role="group" 
                 aria-label="Engagement metrics">
                <span aria-label="{{ post['replies_count'] }} replies"
                      role="img"
                      title="Replies">
                    <span aria-hidden="true">⥄</span>
                    <span class="count">{{ post['replies_count'] }}</span>
                </span>
                <span aria-label="{{ post['reblogs_count'] }} boosts"
                      role="img"
                      title="Boosts">
                    <span aria-hidden="true">↻</span>
                    <span class="count">{{ post['reblogs_count'] }}</span>
                </span>
                <span aria-label="{{ post['favourites_count'] }} favorites"
                      role="img"
                      title="Favorites">
                    <span aria-hidden="true">★</span>
                    <span class="count">{{ post['favourites_count'] }}</span>
                </span>
            </div>
            
        </footer>
        
    </div>

</article>
